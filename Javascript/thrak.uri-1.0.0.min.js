(function($){$.uri=function(href){function uri(href){var $this=this;this.__components={anchor:undefined,directory:undefined,host:undefined,page:undefined,password:undefined,port:undefined,protocol:undefined,user:undefined,href:undefined,hrefLocal:undefined,query:undefined,queryLocal:undefined,locals:[]};this.__parameters=[];this.__anchorParameters=[];if(href)
this.href(href);this.__parameters_api={add:function(query){query&&query.length&&parse_query($this,query,'?','query','__parameters',true);},get:function(name,default_value){for(var i=0;i<this.parameters.length;i++){var param=this.parameters[i];if(param.name==name){if(param.value==undefined)
return(default_value);else return(param.value);}}
return(default_value);},set:function(name,value){var found=-1;for(var i=0;i<this.parameters.length;i++){var param=this.parameters[i];if(param.name==name){found=i;break;}}
if(found>=0){if(value===undefined||!value)
this.parameters.splice(found,1);else this.parameters[found]={name:name,value:value};}
else if(value!==undefined)
this.parameters.push({name:name,value:value});rebuild_computed_fields($this);return(this);},empty:function(){this.parameters=[];rebuild_computed_fields($this);return(this);},defined:function(name){for(var i=0;i<$this.__parameters.length;i++){var param=this.parameters[i];if(param.name==name)
return(true);}
return(false);},remove:function(name){for(var i=0;i<$this.__parameters.length;i++){var param=this.parameters[i];if(param.name==name){this.parameters.splice(i,1);rebuild_computed_fields($this);return(true);}}
return(false);}};}
function parse($this,href){var re=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/;var match=re.exec(href);var path=match[9];var last_slash=path.lastIndexOf('/');var query=match[12];var anchor=match[13];if(anchor)
$this.__components.anchor=anchor;if(match[6])
$this.__components.host=match[6];if(match[5])
$this.__components.password=match[5];if(match[4])
$this.__components.user=match[4];if(match[7])
$this.__components.port=match[7];if(match[1])
$this.__components.protocol=match[1];if(last_slash==-1){if(path.length)
$this.__components.page=path;}
else if(last_slash<path.length-1){$this.__components.directory=path.substring(0,last_slash+1);$this.__components.page=path.substring(last_slash+1);}
else $this.__components.directory=path;query&&query.length&&parse_query($this,query,'?','query','__parameters',false,true);anchor&&anchor.length&&parse_query($this,anchor,'#','anchor','__anchorParameters',false,true);rebuild_computed_fields($this);}
function parse_query($this,query,prefix,component,private_field,append,rebuild){if(query&&query[0]==prefix)
query=query.substring(1);var parts=query.split('&');if(query.length){if(append){$this.__components[component]+=prefix+query;}
else{$this.__components[component]=query;$this[private_field]=[];}
for(var i=0;i<parts.length;i++){var param=parts[i].split('=');var name=param[0],value=(param.length>1)? decodeURI(param[1]):'';if(append)
$this.parameters().set(name,value);else $this[private_field].push({'name':name,'value':value});}}
else{$this.__components[component]=undefined;$this[private_field]=undefined;}
if(rebuild)
rebuild_computed_fields($this);}
function rebuild_computed_fields($this){var components=$this.__components;var url='';var localUrl='';rebuild_query_string($this,'?','queryLocal','query','__parameters',true);rebuild_query_string($this,'#','anchor',undefined,'__anchorParameters',false);if(components.protocol)
url+=components.protocol+'://';if(components.user){url+=components.user+':';if(components.password)
url+=components.password;url+='@';}
if(components.host)
url+=components.host;if(components.port)
url+=':'+components.port;if(components.directory)
url+=components.directory;if(components.page){if(components.directory===undefined)
url+='/';url+=components.page;}
localUrl=url;if(components.query){url+=components.query;localUrl+=components.queryLocal;}
if(components.anchor){url+=components.anchor;localUrl+=components.anchor;}
components.href=localUrl;components.hrefLocal=url;}
function rebuild_query_string($this,prefix,member_name,local_member_name,parameters_array_name,equal_sign_for_empty_value){var components=$this.__components;var parameters=$this[parameters_array_name];if(parameters&&parameters.length>0){var string_parameters=[];var local_string_parameters=[];for(var i=0;i<parameters.length;i++){var string_parameter=parameters[i];var value=string_parameter.name;if((string_parameter.value!==undefined&&string_parameter.value.trim()!='')||equal_sign_for_empty_value)
value+='='+encodeURI(string_parameter.value);string_parameters.push(value);if(components.locals.indexOf(string_parameter.name)<0)
local_string_parameters.push(value);}
components[member_name]=prefix+string_parameters.join('&');if(local_member_name)
components[local_member_name]=prefix+local_string_parameters.join('&');}
else{components[member_name]=undefined;if(local_member_name)
components[local_member_name]=undefined;}}
function set_value($this,field,value){if(value!==undefined){$this.__components[field]=value;rebuild_computed_fields($this);return($this);}
else return($this.__components[field]);}
var prototype=uri.prototype;prototype.anchor=function(value){if(value!==undefined){this.anchorParameters=[];parse_query(this,value,'#','anchor','__anchorParameters',false,true);}
return(set_value(this,'anchor',value));}
prototype.anchorParameters=function(){if(arguments.length>0){var funcname=arguments[0];var argv=Array.prototype.slice.call(arguments,1);if(this.__parameters_api[funcname]){var result=this.__parameters_api[funcname].apply(funcname,argv);return(result);}
else return(undefined);}
else{var params=$.extend(this.__parameters_api,{parameters:this.__anchorParameters});return(params);}}
prototype.components=function(){var result=this.__components;return(result);}
prototype.credentials=function(user,password){if(name){set_value(this,'user',user);set_value(this,'password',password);}
return({user:this.__components.user,password:this.__components.password});}
prototype.directory=function(value){if(value){if(value[0]!='/')
value='/'+value;if(value[value.length-1]!='/')
value+='/';}
return(set_value(this,'directory',value));}
prototype.host=function(value){return(set_value(this,'host',value));}
prototype.href=function(href){if(href!==undefined){parse(this,href);return(this);}
else{return(this.__components.href);}}
prototype.hrefLocal=function(){return(this.__components.hrefLocal);}
prototype.hrefGlobal=function(){return(this.__components.href);}
prototype.locals=function(value){if(typeof(value)==='string')
value=value.split(/[ \t,]/);return(set_value(this,'locals',value));}
prototype.page=function(value){return(set_value(this,'page',value));}
prototype.port=function(value){return(set_value(this,'port',value));}
prototype.parameters=function(){if(arguments.length>0){var funcname=arguments[0];var argv=Array.prototype.slice.call(arguments,1);if(this.__parameters_api[funcname]){var result=this.__parameters_api[funcname].apply(funcname,argv);return(result);}
else return(undefined);}
else{var params=$.extend(this.__parameters_api,{parameters:this.__parameters});return(params);}}
prototype.password=function(value){return(set_value(this,'password',value));}
prototype.path=function(new_path){if(new_path!==undefined){var last_slash=new_path.lastIndexOf('/');if(last_slash>0){this.directory(new_path.substring(0,last_slash+1));this.page(new_path.substring(last_slash+1));}
else{this.directory(undefined);this.page(new_path);}
rebuild_computed_fields(this);}
var result='';if(this.__components.directory!==undefined)
result+=this.__components.directory;if(this.__components.page!==undefined)
result+=this.__components.page;return(result);}
prototype.protocol=function(value){return(set_value(this,'protocol',value));}
prototype.query=function(query){if(query)
parse_query(this,query);rebuild_computed_fields(this);return(this.__components.query);}
prototype.queryLocal=function(query){return(this.__components.queryLocal);}
prototype.query=function(query){return(this.__components.query);}
prototype.samePath=function(other,use_host){if(!use_host||this.__components.host==other.components.host){if(this.__components.path==undefined||this.__components.path=='/'){return(other.__components.path==undefined||other.__components.path=='/');}
else return(this.__components.path==other.__components.path);}
else return(false);}
prototype.user=function(value,password){return(set_value(this,'user',value));}
prototype.toString=function(){return(this.__components.hrefLocal);}
return(new uri(href));}
window.url=$.uri(window.location.href);})(jQuery);